error = function(error_condition)
{ rep(0.01, nrow(test.data.ann)) } )
plot <-   ggplot(test.data.ann, aes(x=log2(test.data.ann[,c(markerGene)]+1), y=log2(test.data.ann[,c(mmpGene)]+1),
group=as.factor(Age), colour=density) ) +
geom_abline(slope=1, intercept=0, colour="black", linetype = "dashed", alpha=0.5) +
#scale_colour_viridis() +
scale_colour_gradientn(colors=viridis_pal()(9), limits=c(0,varScalemax),
breaks=seq(0,varScalemax,0.05), na.value = "#FDE725FF") +
xlim(0,varXmax) + ylim(0,varYmax) +
xlab(paste0(markerGene, " log2(RPKM+1)")) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
geom_point(alpha=0.75, size=2.5) +
facet_grid( ~Age, labeller = labeller(Age = labels) ) +
coord_equal() +
theme(text=element_text(size=12,  family="sans"),
axis.text.x = element_text(size=10), #angle = 45, hjust = 1),
axis.text.y = element_text(size=10),
strip.text.x = element_text(size=10, face="bold")
)
return(plot)
}
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",    varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2", varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- plot_grid(p1, p2, ncol=1)
p3
functionPlotMmpVsMarkerCorrelations <- function(test.data.ann, mmpGene, markerGene, varXmax, varYmax, varScalemax) {
cor5.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.25)[,c(mmpGene)], method="pearson")
cor5.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.5 )[,c(mmpGene)], method="pearson")
cor6.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.25)[,c(mmpGene)], method="pearson")
cor6.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.5 )[,c(mmpGene)], method="pearson")
labels <- c( "5.25"=paste("5.25 \n[ r=", signif(cor5.25$estimate,2), " p=", signif(cor5.25$p.value,2),"]"),
"5.5"=paste("5.5  \n[ r=",  signif(cor5.50$estimate,2), " p=", signif(cor5.50$p.value,2),"]"),
"6.25"=paste("6.25 \n[ r=", signif(cor6.25$estimate,2), " p=", signif(cor6.25$p.value,2),"]"),
"6.5"=paste("6.5  \n[ r=",  signif(cor6.50$estimate,2), " p=", signif(cor6.50$p.value,2),"]") )
#test.data.ann$density <- get_density(log2(test.data.ann[,c(markerGene)]+1), log2(test.data.ann[,c(mmpGene)]+1))
test.data.ann$density <- tryCatch( { get_density(log2(test.data.ann[,c("T")]+1), log2(test.data.ann[,c( MMPs[i])]+1)) },
error = function(error_condition)
{ rep(0.01, nrow(test.data.ann)) } )
plot <-   ggplot(test.data.ann, aes(x=log2(test.data.ann[,c(markerGene)]+1), y=log2(test.data.ann[,c(mmpGene)]+1),
group=as.factor(Age), colour=density) ) +
geom_abline(slope=1, intercept=0, colour="black", linetype = "dashed", alpha=0.5) +
#scale_colour_viridis() +
scale_colour_gradientn(colors=viridis_pal()(9), limits=c(0,varScalemax),
breaks=seq(0,varScalemax,0.05), na.value = "#FDE725FF") +
xlim(0,varXmax) + ylim(0,varYmax) +
xlab(paste0(markerGene, " log2(RPKM+1)")) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
geom_point(alpha=0.75, size=2) +
facet_grid( ~Age, labeller = labeller(Age = labels) ) +
coord_equal() +
theme(text=element_text(size=12,  family="sans"),
axis.text.x = element_text(size=10), #angle = 45, hjust = 1),
axis.text.y = element_text(size=10),
strip.text.x = element_text(size=10, face="bold")
)
return(plot)
}
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",    varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2", varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- plot_grid(p1, p2, ncol=1)
p3
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",    varXmax=10, varYmax=10, varScalemax=0.115)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2", varXmax=10, varYmax=10, varScalemax=0.115)
p3 <- plot_grid(p1, p2, ncol=1)
p3
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",    varXmax=10, varYmax=10, varScalemax=0.10)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2", varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- plot_grid(p1, p2, ncol=1)
p3
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",    varXmax=10, varYmax=10, varScalemax=0.10)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2", varXmax=10, varYmax=10, varScalemax=0.10)
p3 <- plot_grid(p1, p2, ncol=1)
p3
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",     varXmax=10, varYmax=10, varScalemax=0.10)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2",  varXmax=10, varYmax=10, varScalemax=0.10)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Nodal", varXmax=10, varYmax=10, varScalemax=0.10)
p4 <- plot_grid(p1, p2, p3, ncol=1)
p4
p4
for (i in seq(1, (length(MMPs)-3), 1))
{
message(paste0("Running ", i, " and ", MMPs[i]))
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "T",     varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Otx2",  varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Nodal", varXmax=10, varYmax=10, varScalemax=0.125)
p4 <- plot_grid(p1, p2, p3, ncol=1)
pdf(paste0(Project, "_", MMPs[i],".pdf"), width=8,height=5)
par(bg=NA)
print(p3)
dev.off()
png(paste0(Project, "_", MMPs[i],".png"), units="cm", width=20, height=15, res=180)
par(bg=NA)
print(p3)
dev.off()
}
warnings()
for (i in seq(1, (length(MMPs)-3), 1))
{
message(paste0("Running ", i, " and ", MMPs[i]))
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "T",     varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Otx2",  varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Nodal", varXmax=10, varYmax=10, varScalemax=0.125)
p4 <- plot_grid(p1, p2, p3, ncol=1)
pdf(paste0(Project, "_", MMPs[i],".pdf"), width=8,height=5)
par(bg=NA)
print(p4)
dev.off()
png(paste0(Project, "_", MMPs[i],".png"), units="cm", width=20, height=15, res=180)
par(bg=NA)
print(p4)
dev.off()
}
for (i in seq(1, (length(MMPs)-3), 1))
{
message(paste0("Running ", i, " and ", MMPs[i]))
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "T",     varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Otx2",  varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Nodal", varXmax=10, varYmax=10, varScalemax=0.125)
p4 <- plot_grid(p1, p2, p3, ncol=1)
pdf(paste0(Project, "_", MMPs[i],".pdf"), width=7,height=5)
par(bg=NA)
print(p4)
dev.off()
png(paste0(Project, "_", MMPs[i],".png"), units="cm", width=17.5, height=15, res=180)
par(bg=NA)
print(p4)
dev.off()
}
functionPlotMmpVsMarkerCorrelations <- function(test.data.ann, mmpGene, markerGene, varXmax, varYmax, varScalemax) {
cor5.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.25)[,c(mmpGene)], method="pearson")
cor5.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.5 )[,c(mmpGene)], method="pearson")
cor6.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.25)[,c(mmpGene)], method="pearson")
cor6.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.5 )[,c(mmpGene)], method="pearson")
labels <- c( "5.25"=paste("5.25 \n[ r=", signif(cor5.25$estimate,2), " p=", signif(cor5.25$p.value,2),"]"),
"5.5"=paste("5.5  \n[ r=",  signif(cor5.50$estimate,2), " p=", signif(cor5.50$p.value,2),"]"),
"6.25"=paste("6.25 \n[ r=", signif(cor6.25$estimate,2), " p=", signif(cor6.25$p.value,2),"]"),
"6.5"=paste("6.5  \n[ r=",  signif(cor6.50$estimate,2), " p=", signif(cor6.50$p.value,2),"]") )
#test.data.ann$density <- get_density(log2(test.data.ann[,c(markerGene)]+1), log2(test.data.ann[,c(mmpGene)]+1))
test.data.ann$density <- tryCatch( { get_density(log2(test.data.ann[,c("T")]+1), log2(test.data.ann[,c( MMPs[i])]+1)) },
error = function(error_condition)
{ rep(0.01, nrow(test.data.ann)) } )
plot <-   ggplot(test.data.ann, aes(x=log2(test.data.ann[,c(markerGene)]+1), y=log2(test.data.ann[,c(mmpGene)]+1),
group=as.factor(Age), colour=density) ) +
geom_abline(slope=1, intercept=0, colour="black", linetype = "dashed", alpha=0.5) +
#scale_colour_viridis() +
scale_colour_gradientn(colors=viridis_pal()(9), limits=c(0,varScalemax),
breaks=seq(0,varScalemax,0.05), na.value = "#FDE725FF") +
xlim(0,varXmax) + ylim(0,varYmax) +
xlab(paste0(markerGene, " log2(RPKM+1)")) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
geom_point(alpha=0.75, size=2) +
facet_grid( ~Age, labeller = labeller(Age = labels) ) +
coord_equal() +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(size=8), #angle = 45, hjust = 1),
axis.text.y = element_text(size=8),
strip.text.x = element_text(size=8, face="bold")
)
return(plot)
}
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",     varXmax=10, varYmax=10, varScalemax=0.10)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2",  varXmax=10, varYmax=10, varScalemax=0.10)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Nodal", varXmax=10, varYmax=10, varScalemax=0.10)
p4 <- plot_grid(p1, p2, p3, ncol=1)
p4
for (i in seq(1, (length(MMPs)-3), 1))
{
message(paste0("Running ", i, " and ", MMPs[i]))
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "T",     varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Otx2",  varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Nodal", varXmax=10, varYmax=10, varScalemax=0.125)
p4 <- plot_grid(p1, p2, p3, ncol=1)
pdf(paste0(Project, "_", MMPs[i],".pdf"), width=7,height=5)
par(bg=NA)
print(p4)
dev.off()
png(paste0(Project, "_", MMPs[i],".png"), units="cm", width=17.5, height=15, res=180)
par(bg=NA)
print(p4)
dev.off()
}
functionPlotMmpVsMarkerCorrelations <- function(test.data.ann, mmpGene, markerGene, varXmax, varYmax, varScalemax) {
cor5.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.25)[,c(mmpGene)], method="pearson")
cor5.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.5 )[,c(mmpGene)], method="pearson")
cor6.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.25)[,c(mmpGene)], method="pearson")
cor6.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.5 )[,c(mmpGene)], method="pearson")
labels <- c( "5.25"=paste("5.25 \n[ r=", signif(cor5.25$estimate,2), " p=", signif(cor5.25$p.value,2),"]"),
"5.5"=paste("5.5  \n[ r=",  signif(cor5.50$estimate,2), " p=", signif(cor5.50$p.value,2),"]"),
"6.25"=paste("6.25 \n[ r=", signif(cor6.25$estimate,2), " p=", signif(cor6.25$p.value,2),"]"),
"6.5"=paste("6.5  \n[ r=",  signif(cor6.50$estimate,2), " p=", signif(cor6.50$p.value,2),"]") )
#test.data.ann$density <- get_density(log2(test.data.ann[,c(markerGene)]+1), log2(test.data.ann[,c(mmpGene)]+1))
test.data.ann$density <- tryCatch( { get_density(log2(test.data.ann[,c("T")]+1), log2(test.data.ann[,c( MMPs[i])]+1)) },
error = function(error_condition)
{ rep(0.01, nrow(test.data.ann)) } )
plot <-   ggplot(test.data.ann, aes(x=log2(test.data.ann[,c(markerGene)]+1), y=log2(test.data.ann[,c(mmpGene)]+1),
group=as.factor(Age), colour=density) ) +
geom_abline(slope=1, intercept=0, colour="black", linetype = "dashed", alpha=0.5) +
#scale_colour_viridis() +
scale_colour_gradientn(colors=viridis_pal()(9), limits=c(0,varScalemax),
breaks=seq(0,varScalemax,0.05), na.value = "#FDE725FF") +
xlim(0,varXmax) + ylim(0,varYmax) +
xlab(paste0(markerGene, " log2(RPKM+1)")) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
geom_point(alpha=0.75, size=2) +
facet_grid( ~Age, labeller = labeller(Age = labels) ) +
coord_equal() +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(size=8), #angle = 45, hjust = 1),
axis.text.y = element_text(size=8),
strip.text.x = element_text(size=8, face="bold"),
legend.key.height=unit(0.5, "lines"), legend.key.width=unit(0.2, "lines")
)
return(plot)
}
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",     varXmax=10, varYmax=10, varScalemax=0.10)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2",  varXmax=10, varYmax=10, varScalemax=0.10)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Nodal", varXmax=10, varYmax=10, varScalemax=0.10)
p4 <- plot_grid(p1, p2, p3, ncol=1)
p4
for (i in seq(1, (length(MMPs)-3), 1))
{
message(paste0("Running ", i, " and ", MMPs[i]))
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "T",     varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Otx2",  varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Nodal", varXmax=10, varYmax=10, varScalemax=0.125)
p4 <- plot_grid(p1, p2, p3, ncol=1)
pdf(paste0(Project, "_", MMPs[i],".pdf"), width=8,height=6)
par(bg=NA)
print(p4)
dev.off()
png(paste0(Project, "_", MMPs[i],".png"), units="cm", width=17.5, height=15, res=180)
par(bg=NA)
print(p4)
dev.off()
}
functionPlotMmpVsMarkerCorrelations <- function(test.data.ann, mmpGene, markerGene, varXmax, varYmax, varScalemax) {
cor5.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.25)[,c(mmpGene)], method="pearson")
cor5.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==5.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==5.5 )[,c(mmpGene)], method="pearson")
cor6.25 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.25)[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.25)[,c(mmpGene)], method="pearson")
cor6.50 <- cor.test(subset(test.data.ann[, c(markerGene, "Age")], Age==6.5 )[,c(markerGene)],
subset(test.data.ann[, c(mmpGene,    "Age")], Age==6.5 )[,c(mmpGene)], method="pearson")
labels <- c( "5.25"=paste("5.25 \n[ r=", signif(cor5.25$estimate,2), " p=", signif(cor5.25$p.value,2),"]"),
"5.5"=paste("5.5  \n[ r=",  signif(cor5.50$estimate,2), " p=", signif(cor5.50$p.value,2),"]"),
"6.25"=paste("6.25 \n[ r=", signif(cor6.25$estimate,2), " p=", signif(cor6.25$p.value,2),"]"),
"6.5"=paste("6.5  \n[ r=",  signif(cor6.50$estimate,2), " p=", signif(cor6.50$p.value,2),"]") )
#test.data.ann$density <- get_density(log2(test.data.ann[,c(markerGene)]+1), log2(test.data.ann[,c(mmpGene)]+1))
test.data.ann$density <- tryCatch( { get_density(log2(test.data.ann[,c("T")]+1), log2(test.data.ann[,c( MMPs[i])]+1)) },
error = function(error_condition)
{ rep(0.01, nrow(test.data.ann)) } )
plot <-   ggplot(test.data.ann, aes(x=log2(test.data.ann[,c(markerGene)]+1), y=log2(test.data.ann[,c(mmpGene)]+1),
group=as.factor(Age), colour=density) ) +
geom_abline(slope=1, intercept=0, colour="black", linetype = "dashed", alpha=0.5) +
#scale_colour_viridis() +
scale_colour_gradientn(colors=viridis_pal()(9), limits=c(0,varScalemax),
breaks=seq(0,varScalemax,0.05), na.value = "#FDE725FF") +
xlim(0,varXmax) + ylim(0,varYmax) +
xlab(paste0(markerGene, " log2(RPKM+1)")) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
geom_point(alpha=0.75, size=2) +
facet_grid( ~Age, labeller = labeller(Age = labels) ) +
coord_equal() +
theme(text=element_text(size=10,  family="sans"),
axis.text.x = element_text(size=8), #angle = 45, hjust = 1),
axis.text.y = element_text(size=8),
strip.text.x = element_text(size=8, face="bold"),
legend.text=element_text(size=6),
legend.key.height=unit(0.5, "lines"), legend.key.width=unit(0.2, "lines")
)
return(plot)
}
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "T",     varXmax=10, varYmax=10, varScalemax=0.10)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Otx2",  varXmax=10, varYmax=10, varScalemax=0.10)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, "Mmp14", "Nodal", varXmax=10, varYmax=10, varScalemax=0.10)
p4 <- plot_grid(p1, p2, p3, ncol=1)
p4
for (i in seq(1, (length(MMPs)-3), 1))
{
message(paste0("Running ", i, " and ", MMPs[i]))
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "T",     varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Otx2",  varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Nodal", varXmax=10, varYmax=10, varScalemax=0.125)
p4 <- plot_grid(p1, p2, p3, ncol=1)
pdf(paste0(Project, "_", MMPs[i],".pdf"), width=8,height=6)
par(bg=NA)
print(p4)
dev.off()
png(paste0(Project, "_", MMPs[i],".png"), units="cm", width=17.5, height=15, res=180)
par(bg=NA)
print(p4)
dev.off()
}
for (i in seq(1, (length(MMPs)-3), 1))
{
message(paste0("Running ", i, " and ", MMPs[i]))
p1 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "T",     varXmax=10, varYmax=10, varScalemax=0.125)
p2 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Otx2",  varXmax=10, varYmax=10, varScalemax=0.125)
p3 <- functionPlotMmpVsMarkerCorrelations(test.data.ann, MMPs[i], "Nodal", varXmax=10, varYmax=10, varScalemax=0.125)
p4 <- plot_grid(p1, p2, p3, ncol=1)
pdf(paste0(Project, "_", MMPs[i],".pdf"), width=7,height=6)
par(bg=NA)
print(p4)
dev.off()
png(paste0(Project, "_", MMPs[i],".png"), units="cm", width=16, height=15, res=180)
par(bg=NA)
print(p4)
dev.off()
}
sessionInfo()
corner(EPI.cells.rpkm)
test <- EPI.cells.rpkm['Mmp' == row.names(EPI.cells.rpkm),]
test
corner(EPI.cells.rpkm)
test <- grep(pattern = "Mmp", x = rownames(EPI.cells.rpkm))
test
test <- EPI.cells.rpkm[grep(pattern = "Mmp", x = rownames(EPI.cells.rpkm)),]
test
test <- rownames(EPI.cells.rpkm[grep(pattern = "Mmp", x = rownames(EPI.cells.rpkm)),])
test
test <- rownames(EPI.cells.rpkm[grep(pattern = "Colla", x = rownames(EPI.cells.rpkm)),])
test
test <- rownames(EPI.cells.rpkm[grep(pattern = "Cola", x = rownames(EPI.cells.rpkm)),])
test
test <- rownames(EPI.cells.rpkm[grep(pattern = "LOC", x = rownames(EPI.cells.rpkm)),])
test
test <- rownames(EPI.cells.rpkm[grep(pattern = "Clg", x = rownames(EPI.cells.rpkm)),])
test
test <- rownames(EPI.cells.rpkm[grep(pattern = "MM", x = rownames(EPI.cells.rpkm)),])
test
test <- rownames(EPI.cells.rpkm[grep(pattern = "Str", x = rownames(EPI.cells.rpkm)),])
test
head(test.data.ann)
mmpGene <- "Mmp14"
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1),
group=as.factor(Age), colour=Age) ) +
geom_point(alpha=0.75, size=2)
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_point(alpha=0.75, size=2) +
ylab(paste0(mmpGene, " log2(RPKM+1)"))
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_jitter(alpha=0.75, size=2) +
ylab(paste0(mmpGene, " log2(RPKM+1)"))
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_jitter(alpha=0.75, size=2) +
geom_boxplot() +
ylab(paste0(mmpGene, " log2(RPKM+1)"))
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_jitter(alpha=0.75, size=2) +
geom_boxplot(fill=NULL) +
ylab(paste0(mmpGene, " log2(RPKM+1)"))
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=2) +
geom_boxplot() +
ylab(paste0(mmpGene, " log2(RPKM+1)"))
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=2) +
ylab(paste0(mmpGene, " log2(RPKM+1)"))
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
ylab(paste0(mmpGene, " log2(RPKM+1)"))
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
theme(text=element_text(size=10,  family="sans"), legend.position = 'none')
ggplot(test.data.ann, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
test.data.ann.m <- melt(test.data.ann)
head(test.data.ann.m)
#ggplot(test.data.ann.m, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
facet_grid(~variable)
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
facet_grid(~variable) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
facet_grid(variable ~ .) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
#ggplot(test.data.ann.m, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
facet_grid(variable ~ ., ncol=2) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
#ggplot(test.data.ann.m, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=1) +
facet_wrap(variable ~ .) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
#ggplot(test.data.ann.m, aes(x=Age, y=log2(test.data.ann[,c(mmpGene)]+1), group=as.factor(Age), colour=Age) ) +
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ .) +
ylab(paste0(mmpGene, " log2(RPKM+1)")) +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
head(test.data.ann.m)
tst <- test.data.ann.m[grep(pattern = "Mmp", x = test.data.ann.m$variable),])
tst <- test.data.ann.m[grep(pattern = "Mmp", x = test.data.ann.m$variable),]
tst
test.data.ann.m <- melt(test.data.ann)
test.data.ann.m <- test.data.ann.m[grep(pattern = "Mmp", x = test.data.ann.m$variable),]
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ .) +
ylab("log2(RPKM+1)") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ ., ncol=4) +
ylab("log2(RPKM+1)") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ ., ncol=3) +
ylab("log2(RPKM+1)") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
plt.mmp.age <- ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot() +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ ., ncol=3) +
ylab("log2(RPKM+1)") +
ggtitle("Mmp expression vs Epiblast Cell Age") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
pdf(paste0(Project, "_mmp.age",".pdf"), width=5,height=10)
par(bg=NA)
print(plt.mmp.age)
dev.off()
png(paste0(Project, "_mmp.age",".png"), units="cm", width=7.5, height=15, res=180)
par(bg=NA)
print(plt.mmp.age)
dev.off()
png(paste0(Project, "_mmp.age",".png"), units="cm", width=10, height=20, res=180)
par(bg=NA)
print(plt.mmp.age)
dev.off()
png(paste0(Project, "_mmp.age",".png"), units="cm", width=12, height=20, res=180)
par(bg=NA)
print(plt.mmp.age)
dev.off()
?geom_boxplot
plt.mmp.age <- ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot(outlier.fill = NULL) +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ ., ncol=3) +
ylab("log2(RPKM+1)") +
ggtitle("Mmp expression vs Epiblast Cell Age") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
plt.mmp.age
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot(outlier.fill = NULL, outlier.color = NULL) +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ ., ncol=3) +
ylab("log2(RPKM+1)") +
ggtitle("Mmp expression vs Epiblast Cell Age") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot(outlier.fill = NULL, outlier.color = NULL, outlier.alpha = 0) +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ ., ncol=3) +
ylab("log2(RPKM+1)") +
ggtitle("Mmp expression vs Epiblast Cell Age") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
plt.mmp.age <- ggplot(test.data.ann.m, aes(x=Age, y=log2(value+1), group=as.factor(Age), colour=Age) ) +
geom_boxplot(outlier.alpha = 0) +
geom_jitter(alpha=0.75, size=0.1) +
facet_wrap(variable ~ ., ncol=3) +
ylab("log2(RPKM+1)") +
ggtitle("Mmp expression vs Epiblast Cell Age") +
theme(text=element_text(size=12,  family="sans"), legend.position = 'none')
pdf(paste0(Project, "_mmp.age",".pdf"), width=5,height=10)
par(bg=NA)
print(plt.mmp.age)
dev.off()
png(paste0(Project, "_mmp.age",".png"), units="cm", width=12, height=20, res=180)
par(bg=NA)
print(plt.mmp.age)
dev.off()
